<!DOCTYPE html>
<html>

<head>
    <title>MasjidTV Server</title>
</head>

<body style="padding: 8px;">
    <h1>Server started</h1>
    <p id="time"></p>

    <!-- this list need to be updated manually -->
    <h3>List of widgets</h3>
    <ul>
        <li><a href="./src/prayer-h1/index.html">src/prayer-h1/index.html</a></li>
        <li><a href="./src/prayer-h2/index.html">src/prayer-h2/index.html</a></li>
        <li><a href="./src/prayer-v1/index.html">src/prayer-v1/index.html</a></li>
        <li><a href="./src/tarikh-widget/index.html">src/tarikh-widget/index.html</a></li>
    </ul>

    <h3>Backend Server</h3>
    <p id="backend-status">Status: ...</p>
    <p>Only needed for to access config setting. Open <a href="./config.html">config</a>.</p>

    <script>
        function updateTime() {
            var now = new Date();
            var timeString = now.toLocaleTimeString();
            document.getElementById("time").textContent = 'Local time: ' + timeString;
        }

        setInterval(updateTime, 1000);
    </script>

    <script>
        function replacePort(url, newPort) {
            var parser = document.createElement('a');
            parser.href = url;
            var newURL = parser.protocol + "//" + parser.hostname + ":" + newPort + parser.pathname;
            return newURL;
        }

        let newURL = replacePort(window.location.href, 7000); // replace with server port

        fetch(newURL)
            .then(response => {
                if (response.status === 200) {
                    document.getElementById("backend-status").textContent = 'Server is running';
                } else {
                    document.getElementById("backend-status").textContent = `Server responded with code ${response.status}`;
                }
            }).catch(error => {
                document.getElementById("backend-status").textContent = 'Server is not running';
            })
    </script>

</body>

</html>